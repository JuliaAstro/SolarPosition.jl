<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solar Positioning · SolarPosition.jl</title><meta name="title" content="Solar Positioning · SolarPosition.jl"/><meta property="og:title" content="Solar Positioning · SolarPosition.jl"/><meta property="twitter:title" content="Solar Positioning · SolarPosition.jl"/><meta name="description" content="Documentation for SolarPosition.jl."/><meta property="og:description" content="Documentation for SolarPosition.jl."/><meta property="twitter:description" content="Documentation for SolarPosition.jl."/><meta property="og:url" content="https://JuliaAstro.github.io/SolarPosition.jl/positioning/"/><meta property="twitter:url" content="https://JuliaAstro.github.io/SolarPosition.jl/positioning/"/><link rel="canonical" href="https://JuliaAstro.github.io/SolarPosition.jl/positioning/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SolarPosition.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/getting-started/">Getting Started</a></li><li><a class="tocitem" href="../examples/plotting/">Plotting with Makie.jl</a></li></ul></li><li><a class="tocitem" href="../reference/">API reference</a></li><li class="is-active"><a class="tocitem" href>Solar Positioning</a><ul class="internal"><li><a class="tocitem" href="#Available-Algorithms"><span>Available Algorithms</span></a></li><li><a class="tocitem" href="#psa-algorithm"><span>PSA</span></a></li><li><a class="tocitem" href="#noaa-algorithm"><span>NOAA</span></a></li><li><a class="tocitem" href="#walraven-algorithm"><span>Walraven</span></a></li><li><a class="tocitem" href="#usno-algorithm"><span>USNO</span></a></li><li><a class="tocitem" href="#spa-algorithm"><span>SPA</span></a></li></ul></li><li><a class="tocitem" href="../refraction/">Refraction Correction</a></li><li><a class="tocitem" href="../deltat/">Delta T (ΔT)</a></li><li><a class="tocitem" href="../literature/">Literature</a></li><li><a class="tocitem" href="../contributing/">Contributing guidelines</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Solar Positioning</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solar Positioning</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/SolarPosition.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/main/docs/src/positioning.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="solar-positioning-algorithms"><a class="docs-heading-anchor" href="#solar-positioning-algorithms">Solar Positioning</a><a id="solar-positioning-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#solar-positioning-algorithms" title="Permalink"></a></h1><p>All solar position algorithms available in <code>SolarPosition.jl</code>  return solar zenith, elevation, and azimuth angles. Algorithms that include an atmospheric refraction model also return “apparent” (refraction-corrected) values by default. This behavior can be modified by specifying a different refraction algorithm or passing <a href="../refraction/#SolarPosition.Refraction.NoRefraction"><code>NoRefraction</code></a> no refraction correction is desired. See the <a href="../refraction/#refraction-correction">Refraction Correction</a> page for more details on refraction models.</p><p><img src="../assets/solar_position.png" alt="Solar position visualization"/> Figure 1: Visualization of solar position angles: azimuth and zenith. Image source: <a href="../literature/#haputhanthri2021solar">Haputhanthri et al.</a>.</p><p>The solar azimuth angle is typically measured clockwise from true north. The solar zenith angle is the angle between the sun and the vertical direction directly overhead. The solar elevation angle is the complement of the zenith angle (i.e., elevation = 90°- zenith).</p><p>Typically solar position algorithms can take the following set of inputs:</p><ul><li>Observer location: latitude, longitude, and altitude</li><li>Date and time: in UTC or local time with timezone information</li><li>Optional atmospheric parameters: pressure and temperature (for refraction correction)</li></ul><p>As an example, we plot the longest day of the year solar path for an observer located at the Van Gogh museum in Amsterdam (52.35888°N, 4.88185°E) on June 21, 2023:</p><pre><code class="language-julia hljs">using SolarPosition, Dates, CairoMakie

# define observer location (latitude, longitude, altitude in meters)
obs = Observer(52.35888, 4.88185, 100.0)  # Van Gogh Museum, Amsterdam
times = collect(DateTime(2023, 6, 21, 0):Minute(5):DateTime(2023, 6, 21, 23, 55));
positions = solar_position(obs, times, PSA(), HUGHES());

# plot elevation and azimuth over the day
fig = Figure(backgroundcolor = :transparent, textcolor= &quot;#f5ab35&quot;, size = (800, 400))
ax1 = Axis(fig[1, 1], xlabel = &quot;Time (hours)&quot;, ylabel = &quot;Elevation (degrees)&quot;,
    title = &quot;Solar Elevation on June 21, 2023 - Amsterdam&quot;, backgroundcolor = :transparent,
    xticks = 0:3:24)
ax2 = Axis(fig[1, 2], xlabel = &quot;Time (hours)&quot;, ylabel = &quot;Azimuth (degrees)&quot;,
    title = &quot;Solar Azimuth on June 21, 2023 - Amsterdam&quot;, backgroundcolor = :transparent,
    xticks = 0:3:24)
times_hours = [Dates.hour(t) + Dates.minute(t)/60 for t in times]
lines!(ax1, times_hours, positions.elevation, color = &quot;#f5ab35&quot;)
lines!(ax2, times_hours, positions.azimuth, color = &quot;#f5ab35&quot;)
fig</code></pre><img src="6cf2e9aa.png" alt="Example block output"/><h2 id="Available-Algorithms"><a class="docs-heading-anchor" href="#Available-Algorithms">Available Algorithms</a><a id="Available-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Algorithms" title="Permalink"></a></h2><p>The following solar position algorithms are currently implemented in SolarPosition.jl:</p><table><tr><th style="text-align: right">Algorithm</th><th style="text-align: right">Reference</th><th style="text-align: right">Accuracy</th><th style="text-align: right">Default Refraction</th><th style="text-align: right">Status</th></tr><tr><td style="text-align: right"><a href="#SolarPosition.Positioning.PSA"><code>PSA</code></a></td><td style="text-align: right">[<a href="../literature/#BALL01">BALL01</a>]</td><td style="text-align: right">±0.0083°</td><td style="text-align: right">None</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Positioning.NOAA"><code>NOAA</code></a></td><td style="text-align: right">[<a href="../literature/#NOAA">NOA25</a>]</td><td style="text-align: right">±0.0167°</td><td style="text-align: right"><a href="../refraction/#SolarPosition.Refraction.HUGHES"><code>HUGHES</code></a></td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Positioning.Walraven"><code>Walraven</code></a></td><td style="text-align: right">[<a href="../literature/#Wal78">Wal78</a>]</td><td style="text-align: right">±0.0100°</td><td style="text-align: right">None</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Positioning.USNO"><code>USNO</code></a></td><td style="text-align: right">[<a href="../literature/#USNO">U.S25</a>]</td><td style="text-align: right">±0.0500°</td><td style="text-align: right">None</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Positioning.SPA"><code>SPA</code></a></td><td style="text-align: right">[<a href="../literature/#RA04">RA04</a>]</td><td style="text-align: right">±0.0003°</td><td style="text-align: right">Built-in</td><td style="text-align: right">✅</td></tr></table><h2 id="psa-algorithm"><a class="docs-heading-anchor" href="#psa-algorithm">PSA</a><a id="psa-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#psa-algorithm" title="Permalink"></a></h2><p>The PSA (Plataforma Solar de Almería) algorithm is the default high-accuracy solar position algorithm.</p><p>The algorithm was originally published by [<a href="../literature/#BALL01">BALL01</a>] and was later updated by [<a href="../literature/#BMB20">BMB20</a>] with new coefficients for improved accuracy.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Positioning.PSA" href="#SolarPosition.Positioning.PSA"><code>SolarPosition.Positioning.PSA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct PSA &lt;: SolarPosition.Positioning.SolarAlgorithm</code></pre><p>PSA (Plataforma Solar de Almería) solar position algorithm. This algorithm computes the solar position with high accuracy using empirical coefficients. Two coefficient sets are available: 2001 (range 1999-2015) and 2020 (range 2020-2050).</p><p><strong>Accuracy</strong></p><p>Claimed accuracy: ±0.004° for 2020 coefficients, ±0.01° for 2001 coefficients.</p><p><strong>Literature</strong></p><p>This algorithm is based on the work by [<a href="../literature/#BALL01">BALL01</a>] and was updated for 2020 coefficients in [<a href="../literature/#BMB20">BMB20</a>].</p><p><strong>Fields</strong></p><ul><li><code>coeffs::Int64</code>: Coefficient set year (2001 or 2020)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/cf4e1939ce8677e5bea5c52f789479933a761854/src/Positioning/psa.jl#L1-L17">source</a></section></article><h2 id="noaa-algorithm"><a class="docs-heading-anchor" href="#noaa-algorithm">NOAA</a><a id="noaa-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#noaa-algorithm" title="Permalink"></a></h2><p>The NOAA (National Oceanic and Atmospheric Administration) algorithm provides an alternative implementation based on [<a href="../literature/#NOAA">NOA25</a>].</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Positioning.NOAA" href="#SolarPosition.Positioning.NOAA"><code>SolarPosition.Positioning.NOAA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct NOAA &lt;: SolarPosition.Positioning.SolarAlgorithm</code></pre><p>NOAA (National Oceanic and Atmospheric Administration) solar position algorithm. This algorithm is based on NOAA&#39;s Solar Position Calculator implementation. The algorithm is from &quot;Astronomical Algorithms&quot; by Jean Meeus.</p><p>By default, the NOAA algorithm uses the <a href="../refraction/#SolarPosition.Refraction.HUGHES"><code>HUGHES</code></a> atmospheric refraction model which is in accordance with the NOAA solar position calculator.</p><p><strong>Accuracy</strong></p><p>Claimed accuracy: ±0.0167° from years -2000 to +3000 for latitudes within ±72°. For latitudes outside this range, the accuracy is ±0.167°.</p><p><strong>Literature</strong></p><p>Based on the NOAA solar position calculator [<a href="../literature/#NOAA">NOA25</a>] and the work by [<a href="../literature/#MEEUS91">Mee91</a>].</p><p><strong>Fields</strong></p><ul><li><code>delta_t::Union{Nothing, Float64}</code>: Difference between terrestrial time and UT1 [seconds]. If <code>nothing</code>, uses automatic calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/cf4e1939ce8677e5bea5c52f789479933a761854/src/Positioning/noaa.jl#L3-L23">source</a></section></article><h2 id="walraven-algorithm"><a class="docs-heading-anchor" href="#walraven-algorithm">Walraven</a><a id="walraven-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#walraven-algorithm" title="Permalink"></a></h2><p>The Walraven algorithm is a solar position algorithm published in 1978 with stated accuracy of ±0.0100°.</p><p>The algorithm was originally published by [<a href="../literature/#Wal78">Wal78</a>] with corrections from the 1979 Erratum [<a href="../literature/#Wal79">Wal79</a>] and azimuth quadrant correction from [<a href="../literature/#Spe89">Spe89</a>].</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Positioning.Walraven" href="#SolarPosition.Positioning.Walraven"><code>SolarPosition.Positioning.Walraven</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Walraven &lt;: SolarPosition.Positioning.SolarAlgorithm</code></pre><p>Walraven solar position algorithm. The implementation accounts for the 1979 Erratum and correct azimuth quadrant selection.</p><p><strong>Accuracy</strong></p><p>Claimed accuracy is ±0.0100°.</p><p><strong>Literature</strong></p><p>This algorithm is based on [<a href="../literature/#Wal78">Wal78</a>] with corrections from the 1979 Erratum [<a href="../literature/#Wal79">Wal79</a>] and azimuth quadrant correction from [<a href="../literature/#Spe89">Spe89</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/cf4e1939ce8677e5bea5c52f789479933a761854/src/Positioning/walraven.jl#L1-L13">source</a></section></article><h2 id="usno-algorithm"><a class="docs-heading-anchor" href="#usno-algorithm">USNO</a><a id="usno-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#usno-algorithm" title="Permalink"></a></h2><p>The USNO (U.S. Naval Observatory) algorithm provides solar position calculations based on formulas from the USNO&#39;s Astronomical Applications Department.</p><p>The algorithm offers two options for calculating Greenwich mean sidereal time, providing flexibility for different accuracy requirements.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Positioning.USNO" href="#SolarPosition.Positioning.USNO"><code>SolarPosition.Positioning.USNO</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct USNO &lt;: SolarPosition.Positioning.SolarAlgorithm</code></pre><p>USNO (U.S. Naval Observatory) solar position algorithm. This algorithm provides solar position calculations based on the USNO&#39;s Astronomical Applications Department formulas.</p><p><strong>Accuracy</strong></p><p>The accuracy is typically within a few arcminutes for most practical applications. This algorithm is suitable for general-purpose solar position calculations.</p><p><strong>Literature</strong></p><p>The U.S. Naval Observatory (USNO) algorithm is provided in [<a href="../literature/#USNO">U.S25</a>].</p><p><strong>Fields</strong></p><ul><li><p><code>delta_t::Union{Nothing, Float64}</code>: Difference between terrestrial time and UT1 [seconds]. If <code>nothing</code>, uses automatic calculation.</p></li><li><p><code>gmst_option::Int64</code>: Option for calculating Greenwich mean sidereal time (1 or 2)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/cf4e1939ce8677e5bea5c52f789479933a761854/src/Positioning/usno.jl#L1-L16">source</a></section></article><h2 id="spa-algorithm"><a class="docs-heading-anchor" href="#spa-algorithm">SPA</a><a id="spa-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#spa-algorithm" title="Permalink"></a></h2><p>The SPA (Solar Position Algorithm) is the highest-accuracy algorithm available in this package, with uncertainty of ±0.0003° for years between -2000 and 6000.</p><p>The algorithm was published by the National Renewable Energy Laboratory (NREL) in [<a href="../literature/#RA04">RA04</a>] and implements a complete heliocentric, geocentric, and topocentric solar position calculation with periodic terms for Earth heliocentric longitude and latitude.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Positioning.SPA" href="#SolarPosition.Positioning.SPA"><code>SolarPosition.Positioning.SPA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SPA &lt;: SolarPosition.Positioning.SolarAlgorithm</code></pre><p>SPA (Solar Position Algorithm) from NREL. This is the most accurate algorithm for solar position calculation, suitable for high-precision applications.</p><p>The algorithm implements the complete NREL Solar Position Algorithm as described in Reda and Andreas (2004, 2007). It accounts for:</p><ul><li>Heliocentric position of Earth</li><li>Nutation and aberration</li><li>Geocentric and topocentric corrections</li><li>Atmospheric refraction</li><li>Parallax effects</li></ul><p><strong>Accuracy</strong></p><p>Claimed accuracy: ±0.0003° (±1 arcsecond) for years -2000 to 6000.</p><p><strong>Literature</strong></p><p>This algorithm is based on [<a href="../literature/#RA04">RA04</a>] with corrections from the 2007 corrigendum.</p><p><strong>Fields</strong></p><ul><li><p><code>delta_t::Union{Nothing, Float64}</code>: Difference between terrestrial time and UT1 [seconds]. If <code>nothing</code>, uses automatic calculation.</p></li><li><p><code>pressure::Float64</code>: Annual average air pressure [Pa]</p></li><li><p><code>temperature::Float64</code>: Annual average air temperature [°C]</p></li><li><p><code>atmos_refract::Float64</code>: Approximate atmospheric refraction at sunrise/sunset [degrees]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAstro/SolarPosition.jl/blob/cf4e1939ce8677e5bea5c52f789479933a761854/src/Positioning/spa.jl#L1-L23">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reference/">« API reference</a><a class="docs-footer-nextpage" href="../refraction/">Refraction Correction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 31 October 2025 21:19">Friday 31 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
