<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Refraction Correction · SolarPosition.jl</title><meta name="title" content="Refraction Correction · SolarPosition.jl"/><meta property="og:title" content="Refraction Correction · SolarPosition.jl"/><meta property="twitter:title" content="Refraction Correction · SolarPosition.jl"/><meta name="description" content="Documentation for SolarPosition.jl."/><meta property="og:description" content="Documentation for SolarPosition.jl."/><meta property="twitter:description" content="Documentation for SolarPosition.jl."/><meta property="og:url" content="https://JuliaSolarPV.github.io/SolarPosition.jl/refraction/"/><meta property="twitter:url" content="https://JuliaSolarPV.github.io/SolarPosition.jl/refraction/"/><link rel="canonical" href="https://JuliaSolarPV.github.io/SolarPosition.jl/refraction/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SolarPosition.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">SolarPosition.jl</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/getting-started/">Getting Started</a></li><li><a class="tocitem" href="../examples/plotting/">Plotting with Makie.jl</a></li></ul></li><li><a class="tocitem" href="../reference/">API reference</a></li><li><a class="tocitem" href="../positioning/">Solar Positioning</a></li><li class="is-active"><a class="tocitem" href>Refraction Correction</a><ul class="internal"><li><a class="tocitem" href="#hughes-refraction"><span>Hughes</span></a></li><li><a class="tocitem" href="#archer-refraction"><span>Archer</span></a></li><li><a class="tocitem" href="#bennett-refraction"><span>Bennett</span></a></li><li><a class="tocitem" href="#michalsky-refraction"><span>Michalsky</span></a></li><li><a class="tocitem" href="#sg2-refraction"><span>SG2</span></a></li><li><a class="tocitem" href="#spa-refraction"><span>SPARefraction</span></a></li></ul></li><li><a class="tocitem" href="../deltat/">Delta T (ΔT)</a></li><li><a class="tocitem" href="../literature/">Literature</a></li><li><a class="tocitem" href="../contributing/">Contributing guidelines</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Refraction Correction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Refraction Correction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSolarPV/SolarPosition.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/main/docs/src/refraction.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="refraction-correction"><a class="docs-heading-anchor" href="#refraction-correction">Refraction Correction</a><a id="refraction-correction-1"></a><a class="docs-heading-anchor-permalink" href="#refraction-correction" title="Permalink"></a></h1><p>Atmospheric refraction correction algorithms available in SolarPosition.jl.</p><p>Atmospheric refraction causes the apparent position of the sun to differ from its true geometric position. This effect is most pronounced near the horizon and can be corrected using various atmospheric models.</p><table><tr><th style="text-align: right">Algorithm</th><th style="text-align: right">Reference</th><th style="text-align: right">Atmospheric Parameters</th><th style="text-align: right">Status</th></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.HUGHES"><code>HUGHES</code></a></td><td style="text-align: right">[<a href="../literature/#Hug85">Hug85</a>]</td><td style="text-align: right">Pressure, Temperature</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.ARCHER"><code>ARCHER</code></a></td><td style="text-align: right">[<a href="../literature/#Arc80">ABO80</a>]</td><td style="text-align: right">None</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.BENNETT"><code>BENNETT</code></a></td><td style="text-align: right">[<a href="../literature/#Ben82">Ben82</a>]</td><td style="text-align: right">Pressure, Temperature</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.MICHALSKY"><code>MICHALSKY</code></a></td><td style="text-align: right">[<a href="../literature/#Mic88">Mic88</a>]</td><td style="text-align: right">None</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.SG2"><code>SG2</code></a></td><td style="text-align: right">[<a href="../literature/#BW12">BW12</a>]</td><td style="text-align: right">Pressure, Temperature</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right"><a href="#SolarPosition.Refraction.SPARefraction"><code>SPARefraction</code></a></td><td style="text-align: right">[<a href="../literature/#RA04">RA04</a>]</td><td style="text-align: right">Pressure, Temperature</td><td style="text-align: right">✅</td></tr></table><p>To calculate refraction, we can use the <a href="#SolarPosition.Refraction.refraction"><code>refraction</code></a> function:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.refraction" href="#SolarPosition.Refraction.refraction"><code>SolarPosition.Refraction.refraction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">refraction(model::RefractionAlgorithm, elevation::T) where {T&lt;:AbstractFloat}</code></pre><p>Apply atmospheric refraction correction to the given elevation angle(s).</p><p><strong>Arguments</strong></p><ul><li><code>model::RefractionAlgorithm</code>: Refraction model to use (e.g., <code>HUGHES()</code>)</li><li><code>elevation::T</code>: True (unrefracted) solar elevation angle in degrees</li></ul><p><strong>Returns</strong></p><ul><li>Refraction correction in degrees to be added to the elevation angle</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using SolarPosition
hughes = HUGHES(101325.0, 15.0)  # 15°C temperature
elevation = 30.0  # 30 degrees
correction = refraction(hughes, elevation)
apparent_elevation = elevation + correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/Refraction.jl#L47-L67">source</a></section></article><p>This function is typically used internally by the <a href="../reference/#SolarPosition.Positioning.solar_position"><code>solar_position</code></a> function when a refraction algorithm is specified, but is also a publicly available method.</p><div class="admonition is-info" id="Info-3eb9b0128171b74a"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-3eb9b0128171b74a" title="Permalink"></a></header><div class="admonition-body"><p>When using a refraction algorithm like <a href="#SolarPosition.Refraction.HUGHES"><code>HUGHES</code></a><code>()</code>, the <a href="../reference/#SolarPosition.Positioning.solar_position"><code>solar_position</code></a> function returns an <a href="../reference/#SolarPosition.Positioning.ApparentSolPos"><code>ApparentSolPos</code></a> struct containing both true and apparent angles.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.NoRefraction" href="#SolarPosition.Refraction.NoRefraction"><code>SolarPosition.Refraction.NoRefraction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct NoRefraction &lt;: RefractionAlgorithm</code></pre><p>Indicates that no atmospheric refraction correction should be applied.</p><p>This is the default refraction setting for solar position calculations. When used, only basic solar position (azimuth, elevation, zenith) is computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/Refraction.jl#L37-L44">source</a></section></article><div class="admonition is-info" id="Info-b8130f2c8de88a92"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-b8130f2c8de88a92" title="Permalink"></a></header><div class="admonition-body"><p>When using <a href="#SolarPosition.Refraction.NoRefraction"><code>NoRefraction</code></a><code>()</code> (the default), the <a href="../reference/#SolarPosition.Positioning.solar_position"><code>solar_position</code></a> function returns a <a href="../reference/#SolarPosition.Positioning.SolPos"><code>SolPos</code></a> struct containing only the true geometric angles (azimuth, elevation, zenith). In this case, no refraction correction is applied.</p></div></div><h2 id="hughes-refraction"><a class="docs-heading-anchor" href="#hughes-refraction">Hughes</a><a id="hughes-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#hughes-refraction" title="Permalink"></a></h2><p>The Hughes refraction model accounts for atmospheric pressure and temperature effects.</p><p>This model was developed by [<a href="../literature/#Hug85">Hug85</a>] and is used in the SUNAEP software [<a href="../literature/#Zim81">Zim81</a>]. It&#39;s also the basis for the refraction correction in NOAA&#39;s solar position calculator (using fixed pressure of 101325 Pa and temperature of 10°C).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.HUGHES" href="#SolarPosition.Refraction.HUGHES"><code>SolarPosition.Refraction.HUGHES</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct HUGHES{T} &lt;: RefractionAlgorithm</code></pre><p>Hughes refraction model.</p><p>This function was developed by G. Hughes [1] and was used in the SUNAEP software [2].</p><p>It is also used to calculate the refraction correction in the NOAA solar position algorithm using a fixed pressure of 101325 Pa and a temperature of 10 degrees Celsius.</p><p><strong>Fields</strong></p><ul><li><p><code>pressure::Any</code>: Annual average atmospheric pressure [Pascal]</p></li><li><p><code>temperature::Any</code>: Annual average temperature [°C]</p></li></ul><p><strong>Constructor</strong></p><ul><li><code>HUGHES()</code>: Uses default parameters: pressure = 101325 Pa, temperature = 12 °C</li><li><code>HUGHES(pressure, temperature)</code>: Specify custom pressure [Pa] and temperature [°C]</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p>For 5° &lt; elevation ≤ 90°:</p><p class="math-container">\[\frac{58.1}{\tan(el)} - \frac{0.07}{\tan(el)^3} + \frac{8.6 \times 10^{-5}}{\tan(el)^5}\]</p><p>For -0.575° &lt; elevation ≤ 5°:</p><p class="math-container">\[el \cdot (-518.2 + el \cdot (103.4 + el \cdot (-12.79 + el \cdot 0.711))) + 1735\]</p><p>For elevation ≤ -0.575°:</p><p class="math-container">\[\frac{-20.774}{\tan(el)}\]</p><p>where <code>el</code> is the true (unrefracted) solar elevation angle.</p><p>The result is then corrected for temperature and pressure:</p><p class="math-container">\[\text{Refract} \times \frac{283}{273 + T} \times \frac{P}{101325} \times \frac{1}{3600}\]</p><p><strong>Literature</strong></p><p>This function was developed by [<a href="../literature/#Hug85">Hug85</a>] and was used in the SUNAEP software [<a href="../literature/#Zim81">Zim81</a>]. It is also used to calculate the refraction correction in the NOAA solar position algorithm using a fixed pressure of 101325 Pa and a temperature of 10 degrees Celsius.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create Hughes refraction model with default parameters
hughes = HUGHES()

# Or specify custom atmospheric conditions
hughes_custom = HUGHES(101325.0, 25.0)  # 25°C temperature

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(hughes, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/hughes.jl#L1-L65">source</a></section></article><h2 id="archer-refraction"><a class="docs-heading-anchor" href="#archer-refraction">Archer</a><a id="archer-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#archer-refraction" title="Permalink"></a></h2><p>The Archer refraction model is a cosine-based correction that does not require atmospheric parameters.</p><p>This simplified model from [<a href="../literature/#Arc80">ABO80</a>] computes refraction based on the zenith angle using trigonometric relationships. It&#39;s useful when atmospheric data is not available.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.ARCHER" href="#SolarPosition.Refraction.ARCHER"><code>SolarPosition.Refraction.ARCHER</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ARCHER &lt;: RefractionAlgorithm</code></pre><p>Archer refraction model.</p><p>Atmospheric refraction correction based on the Archer algorithm.</p><p>This function calculates the atmospheric refraction correction of the solar elevation angle using the method described by Archer [1]. The method was originally developed to be used with the Walraven solar position algorithm [2].</p><p><strong>Fields</strong></p><p><strong>Constructor</strong></p><ul><li><code>ARCHER()</code>: Creates an Archer refraction model instance</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p class="math-container">\[\begin{aligned}
C &amp;= \cos(Z) + 0.0083 \cdot \left(\frac{1}{0.955 + (20.267 \cdot \cos(Z))} - 0.047121 \right)\\
Z_a &amp;= \arccos(C)\\
\text{refraction} &amp;= Z - Z_a
\end{aligned}\]</p><p>where <span>$Z$</span> is the true solar zenith angle and <span>$Z_a$</span> is the apparent zenith angle.</p><p><strong>Literature</strong></p><p>This method was described by [<a href="../literature/#Arc80">ABO80</a>] and was originally developed to be used with the Walraven solar position algorithm [<a href="../literature/#Wal78">Wal78</a>].</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create Archer refraction model
archer = ARCHER()

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(archer, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/archer.jl#L1-L47">source</a></section></article><h2 id="bennett-refraction"><a class="docs-heading-anchor" href="#bennett-refraction">Bennett</a><a id="bennett-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#bennett-refraction" title="Permalink"></a></h2><p>The Bennett refraction model is widely used in marine navigation and accounts for atmospheric conditions.</p><p>Developed by [<a href="../literature/#Ben82">Ben82</a>], this model provides accurate refraction corrections with adjustments for atmospheric pressure and temperature. It&#39;s particularly effective for low elevation angles.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.BENNETT" href="#SolarPosition.Refraction.BENNETT"><code>SolarPosition.Refraction.BENNETT</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BENNETT{T} &lt;: RefractionAlgorithm</code></pre><p>Bennett refraction model.</p><p>Atmospheric refraction correction based on the Bennett algorithm.</p><p>Calculation of atmospheric refraction correction of the solar elevation angle using the method developed by Bennett [1].</p><p><strong>Fields</strong></p><ul><li><p><code>pressure::Any</code>: Annual average atmospheric pressure [Pascal]</p></li><li><p><code>temperature::Any</code>: Annual average temperature [°C]</p></li></ul><p><strong>Constructor</strong></p><ul><li><code>BENNETT()</code>: Uses default parameters: pressure = 101325 Pa, temperature = 12 °C</li><li><code>BENNETT(pressure, temperature)</code>: Specify custom pressure [Pa] and temperature [°C]</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p class="math-container">\[\text{ref} = \frac{0.28 \cdot P}{T+273} \cdot \frac{0.016667}{\tan(el + 7.31 / (el+4.4))}\]</p><p>where <span>$P$</span> is the local air pressure in hPa, <span>$T$</span> is the local air temperature in °C, and <span>$el$</span> is the true (uncorrected) solar elevation angle.</p><p><strong>Literature</strong></p><p>This method was described by [<a href="../literature/#Ben82">Ben82</a>].</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create Bennett refraction model with default parameters
bennett = BENNETT()

# Or specify custom atmospheric conditions
bennett_custom = BENNETT(101325.0, 25.0)  # 25°C temperature

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(bennett, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/bennett.jl#L1-L46">source</a></section></article><h2 id="michalsky-refraction"><a class="docs-heading-anchor" href="#michalsky-refraction">Michalsky</a><a id="michalsky-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#michalsky-refraction" title="Permalink"></a></h2><p>The Michalsky refraction model uses a rational polynomial approximation.</p><p>From [<a href="../literature/#Mic88">Mic88</a>], this algorithm is part of the Astronomical Almanac&#39;s method for approximate solar position calculations. It includes special handling for very low elevation angles.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.MICHALSKY" href="#SolarPosition.Refraction.MICHALSKY"><code>SolarPosition.Refraction.MICHALSKY</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct MICHALSKY &lt;: RefractionAlgorithm</code></pre><p>Michalsky refraction model.</p><p>Atmospheric refraction correction based on the Michalsky algorithm.</p><p>This function calculates the atmospheric refraction correction of the solar elevation angle using the method described by Michalsky [1].</p><p><strong>Fields</strong></p><p><strong>Constructor</strong></p><ul><li><code>MICHALSKY()</code>: Creates a Michalsky refraction model instance</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p class="math-container">\[\text{ref} = \frac{3.51561 \cdot (0.1594 + 0.0196 \cdot el + 0.00002 \cdot el^2)}{1 + 0.505 \cdot el + 0.0845 \cdot el^2}\]</p><p>where <span>$el$</span> is the true (uncorrected) solar elevation angle.</p><p>Note that 3.51561 = 1013.2 mb / 288.2 °C.</p><p>For elevation angles below -0.56°, the refraction correction is clamped to 0.56°.</p><p><strong>Literature</strong></p><p>This method was described by [<a href="../literature/#Mic88">Mic88</a>].</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create Michalsky refraction model
michalsky = MICHALSKY()

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(michalsky, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/michalsky.jl#L1-L45">source</a></section></article><h2 id="sg2-refraction"><a class="docs-heading-anchor" href="#sg2-refraction">SG2</a><a id="sg2-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#sg2-refraction" title="Permalink"></a></h2><p>The SG2 (Second Generation) refraction algorithm is optimized for fast computation over multi-decadal periods.</p><p>Developed by [<a href="../literature/#BW12">BW12</a>], this algorithm uses a two-regime approach with different formulas for elevations above and below a threshold. It accounts for atmospheric pressure and temperature.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.SG2" href="#SolarPosition.Refraction.SG2"><code>SolarPosition.Refraction.SG2</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SG2{T} &lt;: RefractionAlgorithm</code></pre><p>SG2 refraction model.</p><p>Atmospheric refraction correction based on the algorithm in SG2.</p><p>This function calculates the atmospheric refraction correction of the solar elevation angle using the method developed by Ph. Blanc and L. Wald [1].</p><p><strong>Fields</strong></p><ul><li><p><code>pressure::Any</code>: Annual average atmospheric pressure [Pascal]</p></li><li><p><code>temperature::Any</code>: Annual average temperature [°C]</p></li></ul><p><strong>Constructor</strong></p><ul><li><code>SG2()</code>: Uses default parameters: pressure = 101325 Pa, temperature = 12 °C</li><li><code>SG2(pressure, temperature)</code>: Specify custom pressure [Pa] and temperature [°C]</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p>For <span>$el &gt; -0.01$</span> radians:</p><p class="math-container">\[\frac{P}{1010} \cdot \frac{283}{273+T} \cdot \frac{2.96706 \times 10^{-4}}{\tan(el+0.0031376 \cdot (el+0.089186)^{-1})}\]</p><p>For <span>$el \leq -0.01$</span> radians:</p><p class="math-container">\[-\frac{P}{1010} \cdot \frac{283}{273+T} \cdot \frac{1.005516 \times 10^{-4}}{\tan(el)}\]</p><p>where <span>$el$</span> is the true solar elevation angle, <span>$P$</span> is the local air pressure in hPa, and <span>$T$</span> is the local air temperature in °C.</p><p><strong>Literature</strong></p><p>This method was described by [<a href="../literature/#BW12">BW12</a>].</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create SG2 refraction model with default parameters
sg2 = SG2()

# Or specify custom atmospheric conditions
sg2_custom = SG2(101325.0, 25.0)  # 25°C temperature

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(sg2, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/sg2.jl#L1-L52">source</a></section></article><h2 id="spa-refraction"><a class="docs-heading-anchor" href="#spa-refraction">SPARefraction</a><a id="spa-refraction-1"></a><a class="docs-heading-anchor-permalink" href="#spa-refraction" title="Permalink"></a></h2><p>The SPARefraction (Solar Position Algorithm) refraction model is part of NREL&#39;s high-accuracy solar position algorithm.</p><p>From [<a href="../literature/#RA04">RA04</a>], this is the refraction correction used in NREL&#39;s SPA algorithm, which is accurate to ±0.0003° over the years -2000 to 6000. It includes a configurable refraction limit for below-horizon calculations.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SolarPosition.Refraction.SPARefraction" href="#SolarPosition.Refraction.SPARefraction"><code>SolarPosition.Refraction.SPARefraction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SPARefraction{T} &lt;: RefractionAlgorithm</code></pre><p>SPARefraction - SPA (Solar Position Algorithm) refraction model.</p><p>Atmospheric refraction correction from the SPA algorithm.</p><p>This function calculates the atmospheric refraction correction of the solar elevation angle using the method described in Reda and Andreas&#39;s [1] Solar Position Algorithm (SPA).</p><p><strong>Fields</strong></p><ul><li><p><code>pressure::Any</code>: Annual average atmospheric pressure [Pascal]</p></li><li><p><code>temperature::Any</code>: Annual average temperature [°C]</p></li><li><p><code>refraction_limit::Any</code>: Minimum elevation angle for refraction correction [degrees]</p></li></ul><p><strong>Constructor</strong></p><ul><li><code>SPARefraction()</code>: Uses default parameters: pressure = 101325 Pa, temperature = 12 °C, refraction_limit = -0.5667°</li><li><code>SPARefraction(pressure, temperature)</code>: Specify custom pressure [Pa] and temperature [°C], uses default refraction_limit</li><li><code>SPARefraction(pressure, temperature, refraction_limit)</code>: Also specify refraction limit [degrees]</li></ul><p><strong>Notes</strong></p><p>The equation to calculate the refraction correction is given by:</p><p class="math-container">\[\text{ref} = \frac{P}{1010} \cdot \frac{283}{273 + T} \cdot \frac{1.02}{60 \cdot \tan(el + 10.3/(el + 5.11))}\]</p><p>where <span>$el$</span> is the true solar elevation angle, <span>$P$</span> is the annual average local air pressure in hPa/mbar, and <span>$T$</span> is the annual average local air temperature in °C.</p><p>The refraction limit parameter determines the solar elevation angle below which refraction is not applied, as the sun is assumed to be below horizon. Note that the sun diameter (0.26667°) is added to this limit.</p><p><strong>Literature</strong></p><p>This method was described by [<a href="../literature/#RA04">RA04</a>].</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using SolarPosition

# Create SPARefraction model with default parameters
spa = SPARefraction()

# Or specify custom atmospheric conditions
spa_custom = SPARefraction(101325.0, 25.0)  # 25°C temperature

# With custom refraction limit
spa_limit = SPARefraction(101325.0, 12.0, -1.0)  # Don&#39;t correct below -1°

# Apply refraction correction to elevation angle
elevation = 30.0  # degrees
refraction_correction = refraction(spa, elevation)
apparent_elevation = elevation + refraction_correction</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSolarPV/SolarPosition.jl/blob/bd5a61ac47ef9a3872d47a2f9dfcf9780ffad88c/src/Refraction/spa.jl#L1-L55">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../positioning/">« Solar Positioning</a><a class="docs-footer-nextpage" href="../deltat/">Delta T (ΔT) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 24 October 2025 23:41">Friday 24 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
